local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer

getgenv().DNggUI_values = getgenv().DNggUI_values or {}
getgenv().scriptName = getgenv().scriptName or "DNgg Hub"

-- MAIN GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "DNggHubUI_Lib"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- ░░░ MAIN WINDOW ░░░ --
local main = Instance.new("Frame")
main.Size = UDim2.new(0, 360, 0, 310)
main.Position = UDim2.new(0.35, 0, 0.28, 0)
main.BackgroundColor3 = Color3.fromRGB(22, 26, 40)
main.BorderSizePixel = 0
main.Active = true
main.Draggable = true
main.Parent = screenGui

Instance.new("UICorner", main).CornerRadius = UDim.new(0, 8)

-- TITLE BAR
local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1, -80, 0, 32)
title.Position = UDim2.new(0, 12, 0, 0)
title.BackgroundTransparency = 1
title.Text = scriptName
title.TextSize = 16
title.Font = Enum.Font.GothamBold
title.TextColor3 = Color3.fromRGB(235, 240, 255)
title.TextXAlignment = Enum.TextXAlignment.Left

local close = Instance.new("TextButton", main)
close.Size = UDim2.new(0, 26, 0, 26)
close.Position = UDim2.new(1, -34, 0, 3)
close.Text = "X"
close.Font = Enum.Font.GothamBold
close.TextSize = 14
close.BackgroundColor3 = Color3.fromRGB(150, 45, 45)
close.TextColor3 = Color3.fromRGB(255,255,255)
close.BorderSizePixel = 0
Instance.new("UICorner", close).CornerRadius = UDim.new(0, 6)

local minimize = Instance.new("TextButton", main)
minimize.Size = UDim2.new(0, 26, 0, 26)
minimize.Position = UDim2.new(1, -66, 0, 3)
minimize.Text = "-"
minimize.Font = Enum.Font.GothamBold
minimize.TextSize = 14
minimize.BackgroundColor3 = Color3.fromRGB(45,60,90)
minimize.TextColor3 = Color3.fromRGB(255,255,255)
minimize.BorderSizePixel = 0
Instance.new("UICorner", minimize).CornerRadius = UDim.new(0, 6)

-- CONTENT AREA
local content = Instance.new("ScrollingFrame", main)
content.Size = UDim2.new(1, -10, 1, -48)
content.Position = UDim2.new(0, 5, 0, 40)
content.BackgroundTransparency = 1
content.ScrollBarThickness = 4
content.CanvasSize = UDim2.new(0,0,0,0)
content.AutomaticCanvasSize = Enum.AutomaticSize.Y
content.ClipsDescendants = true

local layout = Instance.new("UIListLayout", content)
layout.SortOrder = Enum.SortOrder.LayoutOrder
layout.Padding = UDim.new(0, 10)

-- DESCRIPTION CREATOR
local function createDescription(parent, text)
	if not text then return end

	local desc = Instance.new("TextLabel")
	desc.Parent = parent
	desc.BackgroundTransparency = 1
	desc.Text = text
	desc.Font = Enum.Font.Gotham
	desc.TextSize = 12
	desc.TextColor3 = Color3.fromRGB(180, 185, 200)
	desc.TextWrapped = true
	desc.TextXAlignment = Enum.TextXAlignment.Left
	desc.Size = UDim2.new(1, -6, 0, 0)
	desc.AutomaticSize = Enum.AutomaticSize.Y

	return desc
end

-- ELEMENT LINE
local function createLine(height)
	local frame = Instance.new("Frame")
	frame.Size = UDim2.new(1, 0, 0, height or 32)
	frame.BackgroundTransparency = 1

	local layout = Instance.new("UIListLayout", frame)
	layout.SortOrder = Enum.SortOrder.LayoutOrder
	layout.Padding = UDim.new(0, 4)

	return frame
end

-- LIBRARY
local ui = {}
ui.__index = ui

-- LABEL
function ui:AddLabel(text, desc)
	local line = createLine()
	
	local lbl = Instance.new("TextLabel", line)
	lbl.Size = UDim2.new(1, 0, 0, 22)
	lbl.BackgroundTransparency = 1
	lbl.Text = text
	lbl.Font = Enum.Font.Gotham
	lbl.TextSize = 14
	lbl.TextColor3 = Color3.fromRGB(230,235,255)
	lbl.TextXAlignment = Enum.TextXAlignment.Left

	createDescription(line, desc)

	line.Parent = content
	return lbl
end

-- SECTION
function ui:AddSection(text)
	local sec = Instance.new("Frame")
	sec.Size = UDim2.new(1, 0, 0, 34)
	sec.BackgroundColor3 = Color3.fromRGB(28, 32, 52)
	sec.BorderSizePixel = 0
	Instance.new("UICorner", sec).CornerRadius = UDim.new(0, 6)

	local lbl = Instance.new("TextLabel", sec)
	lbl.Size = UDim2.new(1, -12, 1, 0)
	lbl.Position = UDim2.new(0, 12, 0, 0)
	lbl.BackgroundTransparency = 1
	lbl.Text = text
	lbl.Font = Enum.Font.GothamBold
	lbl.TextSize = 14
	lbl.TextColor3 = Color3.fromRGB(200, 210, 230)
	lbl.TextXAlignment = Enum.TextXAlignment.Left

	sec.Parent = content
	return sec
end

-- BUTTON
function ui:AddButton(text, callback, desc)
	local line = createLine()

	local btn = Instance.new("TextButton", line)
	btn.Size = UDim2.new(1, 0, 0, 32)
	btn.BackgroundColor3 = Color3.fromRGB(50,65,100)
	btn.BorderSizePixel = 0
	btn.Font = Enum.Font.GothamMedium
	btn.TextSize = 14
	btn.TextColor3 = Color3.fromRGB(255,255,255)
	btn.Text = text
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)

	btn.MouseButton1Click:Connect(function()
		pcall(callback)
	end)

	createDescription(line, desc)

	line.Parent = content
	return btn
end

-- TOGGLE
function ui:AddToggle(name, default, callback, desc)
	getgenv().DNggUI_values[name] = default or false

	local line = createLine()

	local txt = Instance.new("TextLabel", line)
	txt.Size = UDim2.new(0.65, 0, 0, 22)
	txt.BackgroundTransparency = 1
	txt.Font = Enum.Font.Gotham
	txt.TextSize = 14
	txt.TextColor3 = Color3.fromRGB(230,235,255)
	txt.Text = name
	txt.TextXAlignment = Enum.TextXAlignment.Left

	local btn = Instance.new("TextButton", line)
	btn.Size = UDim2.new(0.3, 0, 0, 22)
	btn.Position = UDim2.new(0.7, 0, 0, 0)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 13
	btn.BorderSizePixel = 0
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)

	local function refresh()
		if getgenv().DNggUI_values[name] then
			btn.BackgroundColor3 = Color3.fromRGB(0,170,80)
			btn.Text = "ON"
		else
			btn.BackgroundColor3 = Color3.fromRGB(170,40,40)
			btn.Text = "OFF"
		end
	end

	refresh()

	btn.MouseButton1Click:Connect(function()
		getgenv().DNggUI_values[name] = not getgenv().DNggUI_values[name]
		refresh()
		pcall(callback, getgenv().DNggUI_values[name])
	end)

	createDescription(line, desc)

	line.Parent = content
	return btn
end

-- DROPDOWN
function ui:AddDropdown(name, options, default, callback, desc)
	if type(options) ~= "table" then options = {"Option"} end
	local index = default or 1

	getgenv().DNggUI_values[name] = options[index]

	local line = createLine()

	local lbl = Instance.new("TextLabel", line)
	lbl.Size = UDim2.new(0.6, 0, 0, 22)
	lbl.BackgroundTransparency = 1
	lbl.Text = name
	lbl.Font = Enum.Font.Gotham
	lbl.TextSize = 14
	lbl.TextColor3 = Color3.fromRGB(230,235,255)
	lbl.TextXAlignment = Enum.TextXAlignment.Left

	local btn = Instance.new("TextButton", line)
	btn.Size = UDim2.new(0.38, 0, 0, 22)
	btn.Position = UDim2.new(0.62, 0, 0, 0)
	btn.Text = options[index]
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 13
	btn.BorderSizePixel = 0
	btn.BackgroundColor3 = Color3.fromRGB(50,65,100)
	btn.TextColor3 = Color3.fromRGB(255,255,255)
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0,6)

	btn.MouseButton1Click:Connect(function()
		index += 1
		if index > #options then index = 1 end
		btn.Text = options[index]
		getgenv().DNggUI_values[name] = options[index]
		pcall(callback, options[index])
	end)

	createDescription(line, desc)

	line.Parent = content

	return btn
end


-- ░░░ NOTIFICATION SYSTEM ░░░ --

local notifHolder = Instance.new("Frame", screenGui)
notifHolder.Size = UDim2.new(1, 0, 1, 0)
notifHolder.BackgroundTransparency = 1
notifHolder.ZIndex = 2000

local notifList = Instance.new("UIListLayout", notifHolder)
notifList.SortOrder = Enum.SortOrder.LayoutOrder
notifList.Padding = UDim.new(0, 6)
notifList.VerticalAlignment = Enum.VerticalAlignment.Top

function ui:Notify(title, message, duration)
	duration = duration or 3

	local box = Instance.new("Frame")
	box.Size = UDim2.new(0, 260, 0, 0)
	box.BackgroundColor3 = Color3.fromRGB(30, 36, 55)
	box.BorderSizePixel = 0
	box.Parent = notifHolder
	Instance.new("UICorner", box).CornerRadius = UDim.new(0, 8)

	local layout = Instance.new("UIListLayout", box)
	layout.SortOrder = Enum.SortOrder.LayoutOrder
	layout.Padding = UDim.new(0, 4)

	local titleLbl = Instance.new("TextLabel", box)
	titleLbl.Text = title
	titleLbl.Font = Enum.Font.GothamBold
	titleLbl.TextColor3 = Color3.fromRGB(255,255,255)
	titleLbl.BackgroundTransparency = 1
	titleLbl.TextSize = 14
	titleLbl.Size = UDim2.new(1, -10, 0, 18)
	titleLbl.TextXAlignment = Enum.TextXAlignment.Left
	titleLbl.Position = UDim2.new(0, 5, 0, 0)

	local msgLbl = Instance.new("TextLabel", box)
	msgLbl.Text = message
	msgLbl.Font = Enum.Font.Gotham
	msgLbl.TextColor3 = Color3.fromRGB(200,200,220)
	msgLbl.BackgroundTransparency = 1
	msgLbl.TextSize = 13
	msgLbl.Size = UDim2.new(1, -10, 0, 0)
	msgLbl.AutomaticSize = Enum.AutomaticSize.Y
	msgLbl.TextWrapped = true
	msgLbl.TextXAlignment = Enum.TextXAlignment.Left
	msgLbl.Position = UDim2.new(0,5,0,0)

	-- Expand animation
	box.Size = UDim2.new(0, 260, 0, titleLbl.AbsoluteSize.Y + msgLbl.AbsoluteSize.Y + 20)
	TweenService:Create(box, TweenInfo.new(0.25, Enum.EasingStyle.Sine), {BackgroundTransparency = 0}):Play()

	task.delay(duration, function()
		TweenService:Create(box, TweenInfo.new(0.25), {BackgroundTransparency = 1}):Play()
		task.wait(0.25)
		box:Destroy()
	end)
end

-- CLOSE
close.MouseButton1Click:Connect(function()
	screenGui:Destroy()
end)

-- MINIMIZE
local minimized = false
minimize.MouseButton1Click:Connect(function()
	minimized = not minimized
	content.Visible = not minimized

	local goal = minimized and UDim2.new(0, 360, 0, 40) or UDim2.new(0, 360, 0, 310)
	TweenService:Create(main, TweenInfo.new(0.25), {Size = goal}):Play()
end)

-- RETURN LIB
DNggUI = {}
setmetatable(DNggUI, {__index = ui})
return DNggUI
